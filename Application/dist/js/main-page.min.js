angular.module("mainPageApp",["ui.router","LocalStorageModule","ngAnimate","ui.bootstrap"]),function(){"use strict";function e(e,t,n){function a(){return o()}function o(){function n(e){r.roles=e.data}function a(t){e.reject(t)}return t.getAllRoles().then(n)["catch"](a)}var r=this;r.roles=[],r.invitation={RoleName:"",EmployeesEmails:"",EmployerEmail:""},r.sendInvites=function(){function e(){alert("Invitation is sent!")}function a(){alert("Some users already exist!")}return r.invitation.EmployerEmail=n.get("authorizationData").userName,t.sendInvitation(r.invitation).then(e)["catch"](a)},a()}angular.module("mainPageApp").controller("UserInvitation",e),e.$inject=["$q","invitationService","localStorageService"]}(),function(){"use strict";function e(e,t){function n(){function n(e){o.resolve(e)}function a(e){o.reject(e)}var o=t.defer();return e({method:"GET",url:"http://localhost:4446/api/UserRoles/GetRoles"}).then(n)["catch"](a),o.promise}function a(t){return e.post("http://localhost:4446/api/EmployeesInvitation/SendInvitation",t)}var o={getAllRoles:n,sendInvitation:a};return o}angular.module("mainPageApp").factory("invitationService",e),e.$inject=["$http","$q"]}(),function(){"use strict";function e(e,t,n){function a(t){return e({method:"GET",url:n+"api/tasks/"+t})}function o(){return e({method:"GET",url:n+"api/tasks/statuses"})}function r(t){return e({method:"POST",url:n+"api/tasks/update",data:t})}var i={getTaskStatuses:o,getTaskInformation:a,updateTaskInformation:r};return i}angular.module("mainPageApp").factory("employeeTaskService",e),e.$inject=["$http","$q","baseUrl"]}(),function(){"use strict";function e(e,t,n,a,o,r){function i(){n?(h.data=n.data,h.modalTitle="Edit task information"):(h.data={},h.data.taskId=h.newTaskId,h.modalTitle="Add new task"),h.projectCanBeSelected=j(h.data.employeeId),h.statusCanBeSelected=j(h.data.employeeId),h.employeeTask={taskId:h.data.taskId,taskName:h.data.taskName,projectId:h.data.projectId,userId:h.data.employeeId,statusId:h.data.statusId,description:h.data.description}}function c(){function t(t){e.close()}function n(){}o.updateTaskInformation(h.employeeTask).then(t)["catch"](n)}function s(){e.dismiss("cancel")}function l(){function e(e){h.projects=e.data}function t(){h.data.projectName=h.dataNotRecievedMsg}r.getProjectsList(h.employeeTask.userId).then(e)["catch"](t)}function u(){function e(e){h.employees=t("orderBy")(e.data,"secondName")}function n(){h.data.employeeFirstName=h.data.employeeSecondName=h.dataNotRecievedMsg}a.getAll().then(e)["catch"](n)}function m(){function e(e){h.statuses=e.data}function t(){h.data.statusName=h.dataNotRecievedMsg}o.getTaskStatuses().then(e)["catch"](t)}function p(e){h.employeeTask.statusId=e.id,h.data.statusName=e.name}function d(e){h.employeeTask.userId=e.userId,h.data.employeeFirstName=e.firstName,h.data.employeeSecondName=e.secondName,h.data.projectName="",h.employeeTask.projectId=void 0,h.projectCanBeSelected=j(e)}function f(e){h.employeeTask.projectId=e.projectId,h.data.projectName=e.name,h.statusCanBeSelected=j(e)}function g(){return j(h.employeeTask.userId)&&j(h.employeeTask.projectId)&&j(h.employeeTask.statusId)}function j(e){return void 0!=e&&null!=e}var h=this;h.employees=[],h.statuses=[],h.projects=[],h.save=c,h.cancel=s,h.getEmployees=u,h.getStatuses=m,h.getProjects=l,h.selectStatus=p,h.selectEmployee=d,h.selectProject=f,h.checkPristine=g,h.modalTitle="",h.newTaskId=0,h.projectCanBeSelected=!1,h.statusCanBeSelected=!1,h.dataNotRecievedMsg="No data has been recieved.",i()}angular.module("mainPageApp").controller("employeeTaskController",e),e.$inject=["$uibModalInstance","$filter","taskObject","employeeListService","employeeTaskService","employeeProjectListService"]}(),function(){"use strict";function e(e,t,n){function a(t,a,o){return e({method:"GET",url:n+"api/employees/"+t+"/projects/"+a+"/"+o})}function o(t){return e({method:"GET",url:n+"api/employees/"+t+"/projects"})}var r={getProjects:a,getProjectsList:o};return r}angular.module("mainPageApp").factory("employeeProjectListService",e),e.$inject=["$http","$q","baseUrl"]}(),function(){"use strict";function e(e,t,n,a,o,r){function i(){d.itemListEmptyMsg="Please choose employee first.",r.subscribe("employeeSelected",c)}function c(e){e>0?(f=e,d.pager.pageNum=d.startPageNum,s()):(d.projects=[],d.itemListEmptyMsg="Please choose employee first.")}function s(){return l(f,d.pager.pageNum,d.pager.numPerPage)}function l(t,a,r){function i(e){return d.itemListEmptyMsg="Employee has not been involved.",d.projects=n("orderBy")(e.data.items,"createDate",!0),d.pager.totalEntries=e.data.totalCount,e}function c(t){e.reject(t)}function s(){d.getEmployeeProjectsServiceIsBusy=!1}d.getEmployeeProjectsServiceIsBusy=!0,d.itemListEmptyMsg="Projects information is loading...",o.getProjects(t,a,r).then(i)["catch"](c)["finally"](s)}function u(e){d.selectedTask=e,p(d.isOpenForEdit)}function m(){p(!d.isOpenForEdit)}function p(e){function t(){s()}function n(){}var o=a.open({animatation:!0,templateUrl:"/app/mainPage/managerWorkspace/employeeTask.html",size:"sm",controller:"employeeTaskController",controllerAs:"etask",resolve:{taskObject:function(t){return e==d.isOpenForEdit?t.getTaskInformation(d.selectedTask):null}}});o.result.then(t)["catch"](n)}var d=this,f=-1;d.projects=[],d.pager={size:5,pageNum:1,numPerPage:10,totalEntries:0},d.startPageNum=1,d.itemListEmptyMsg="",d.selectedTask=-1,d.isOpenForEdit=!0,d.getEmployeeProjectsServiceIsBusy=!1,d.search=s,d.editTask=u,d.addTask=m,i()}angular.module("mainPageApp").controller("EmployeeProjectListController",e),e.$inject=["$q","$scope","$filter","$uibModal","employeeProjectListService","notificationService"]}(),function(){"use strict";function e(e,t,n){function a(){return e({method:"GET",url:n+"api/employees"})}var o={getAll:a};return o}angular.module("mainPageApp").factory("employeeListService",e),e.$inject=["$http","$q","baseUrl"]}(),function(){"use strict";function e(e,t,n,a,o){function r(){return i()}function i(){function o(n){function a(){return l.search}function o(e){c(l.initialIndexValue),l.filteredData=t("itemSearchFilter")(l.names,"secondName",e)}return l.names=n.data,l.itemListEmptyMsg="Employee list is empty.",e.$watch(a,o),n}function r(e){l.itemListEmptyMsg="No data has been received from server. Status code : "+e.status,n.reject(e)}function i(){l.getUsersServiceIsBusy=!1}return l.getUsersServiceIsBusy=!0,l.itemListEmptyMsg="User information loading...",a.getAll().then(o)["catch"](r)["finally"](i)}function c(e){l.selectedItem=e,o.fire("employeeSelected",e)}function s(){return l.selectedItem}var l=this;l.names=[],l.filteredData=[],l.initialIndexValue=-1,l.selectedItem=l.initialIndexValue,l.maxFilteredNames=10,l.search="",l.itemListEmptyMsg="",l.getUsersServiceIsBusy=!1,l.setActiveItem=c,l.getActiveItem=s,r()}angular.module("mainPageApp").controller("EmployeeListController",e),e.$inject=["$scope","$filter","$q","employeeListService","notificationService"]}(),function(){"use strict";function e(e,t,n){function a(t){return e.get(n+"api/employees"+t)}function o(t){return e.post(n+"api/employees/update"+t)}var r={getUserInfo:a,sendChanges:o};return r}angular.module("mainPageApp").factory("employeeInfoService",e),e.$inject=["$http","$q","baseUrl"]}(),function(){"use strict";function e(e,t,n,a,o){function r(){o.subscribe("employeeSelected",i)}function i(e){s=e}var c=this,s=-1;r(),c.user={userId:"",firstName:"",secondName:"",address:"",phone:"",email:"",roleId:""},c.message="",c.getUserInfo=function(){function e(e){c.user=e.data}function n(e){t.reject(e)}return a.getUserInfo(s).then(e)["catch"](n)},c.updateUserInfo=function(){function e(e){c.message="Changes are saved",c.showMessage=!0,n(function(){n(function(){c.showMessage=!1},2e3)},1e3)}function o(e){t.reject(e)}a.sendChanges(c.user).then(e)["catch"](o)}}angular.module("mainPageApp").controller("EmployeeInfoController",e),e.$inject=["$scope","$q","$timeout","employeeInfoService","notificationService"]}(),function(){"use strict";function e(e,t,n){function a(){function a(e){r.resolve(e)}function o(e){r.reject(e)}var r=t.defer();return e({method:"GET",url:n+"api/projects"}).then(a)["catch"](o),r.promise}var o={getAll:a};return o}angular.module("mainPageApp").factory("projectListService",e),e.$inject=["$http","$q","baseUrl"]}(),function(){"use strict";function e(e,t,n,a,o){function r(){return o.subscribe("projectUpdated",i),c()}function i(e){var t=-1;u.project.forEach(function(n,a){n.projectId==e.projectId&&(t=a)}),u.project[t].name=e.name}function c(){function o(n){function a(){return u.search}function o(e){u.selectedItem=-1,u.filteredData=t("itemSearchFilter")(u.project,"Name",e)}return u.project=n.data,u.itemListEmptyMsg="Project list is empty.",e.$watch(a,o),n}function r(e){u.itemListEmptyMsg="No data has been received from server. Status code : "+e.status,n.reject(e)}function i(){u.getProjectsServiceIsBusy=!1}return u.getProjectsServiceIsBusy=!0,u.itemListEmptyMsg="Projects loading...",a.getAll().then(o)["catch"](r)["finally"](i)}function s(e){u.selectedItem=e,o.fire("projectSelected",e)}function l(){return u.selectedItem}var u=this;u.project=[],u.filteredData=[],u.selectedItem=-1,u.maxFilteredNames=10,u.search="",u.itemListEmptyMsg="",u.getProjectsServiceIsBusy=!1,u.setActiveItem=s,u.getActiveItem=l,r()}angular.module("mainPageApp").controller("ProjectListController",e),e.$inject=["$scope","$filter","$q","projectListService","notificationService"]}(),function(){"use strict";function e(e,t){function n(t){return e.get("http://localhost:4446/api/projects/"+t)}function a(t){return e.post("http://localhost:4446/api/projects/update",t)}var o={sendChanges:a,getProject:n};return o}angular.module("mainPageApp").factory("projectInformationService",e),e.$inject=["$http","$q"]}(),function(){"use strict";function e(e,t,n,a,o,r){function i(){r.subscribe("projectSelected",c)}function c(e){return l=e,s.getProject()}var s=this,l=-1;i(),s.project={projectId:"",name:"No project selected",statusId:"",createDate:"",endDate:"",description:"",employees:""},s.savedMessage="",s.startDateOpened=!1,s.endDateOpened=!1,s.setStartDate=function(e,t,n){s.project.createDate=new Date(e,t,n)},s.setEndDate=function(e,t,n){s.project.endDate=new Date(e,t,n)},s.openStartDate=function(){s.startDateOpened=!0},s.openEndDate=function(){s.endDateOpened=!0},s.saveChanges=function(){function e(e){s.message="Changes saved",s.showMessage=!0,r.fire("projectUpdated",s.project),n(function(){n(function(){s.showMessage=!1},2e3)},1e3)}function a(e){t.reject(e)}o.sendChanges(s.project).then(e)["catch"](a)},s.items=["item1","item2","item3"],s.openModal=function(){function e(e){}function t(e){}var n=a.open({animation:!0,templateUrl:"/app/mainPage/managerProjects/addEmployeesModal.html",controller:"addEmployeesModalController",controllerAs:"addEmplModalContr",resolve:{items:function(){return s.items}}});n.result.then(e)["catch"](t)},s.getProject=function(){function e(e){s.project=e.data}function n(e){t.reject(e)}return o.getProject(l).then(e)["catch"](n)}}angular.module("mainPageApp").controller("ProjectInformationController",e),e.$inject=["$scope","$q","$timeout","$uibModal","projectInformationService","notificationService"]}(),function(){"use strict";function e(e){function t(){}var n=this;n.title="addEmployeesModal",t()}angular.module("mainPageApp").controller("addEmployeesModal",e),e.$inject=["$location"]}(),function(){"use strict";function e(e,t,n,a){function o(){r()}function r(){function o(n){function a(){return i.search}function o(e){i.filteredData=t("itemSearchFilter")(i.names,"secondName",e)}return i.names=n.data,e.$watch(a,o),n}function r(e){n.reject(e)}return a.getAll().then(o)["catch"](r)}var i=this;i.names=[],i.filteredData=[],o()}angular.module("mainPageApp").controller("addEmployeesModalController",e),e.$inject=["$scope","$filter","$q","employeeListService"]}(),function(){"use strict";function e(e){return function(t,n,a){if(angular.isArray(t)&&n){var o=e("orderBy")(t,n);return e("filter")(o,a)}}}angular.module("mainPageApp").filter("itemSearchFilter",e),e.$inject=["$filter"]}(),function(){"use strict";function e(e,t){t.otherwise("/managerWorkspace"),e.state("managerWorkspace",{url:"/managerWorkspace",views:{"@":{templateUrl:"/app/mainPage/managerWorkspace/managerWorkspace.html"},"empList@managerWorkspace":{templateUrl:"/app/mainPage/managerWorkspace/employeeList.html",controller:"EmployeeListController",controllerAs:"elist"},"empInfo@managerWorkspace":{templateUrl:"/app/mainPage/managerWorkspace/employeeInfo.html",controller:"EmployeeInfoController",controllerAs:"einfo"},"empProjectList@managerWorkspace":{templateUrl:"/app/mainPage/managerWorkspace/employeeProjectList.html",controller:"EmployeeProjectListController",controllerAs:"plist"}}}).state("managerProjects",{url:"/managerProjects",views:{"@":{templateUrl:"/app/mainPage/managerProjects/managerProjects.html"},"projectList@managerProjects":{templateUrl:"/app/mainPage/managerProjects/projectList.html",controller:"ProjectListController",controllerAs:"projectList"},"projectInformation@managerProjects":{templateUrl:"/app/mainPage/managerProjects/projectInformation.html",controller:"ProjectInformationController",controllerAs:"projectInformation"}}})}angular.module("mainPageApp").config(e),e.$inject=["$stateProvider","$urlRouterProvider"]}(),function(){"use strict";function e(){function e(e,t){if(angular.isString(e)&&angular.isFunction(t)){var o=n(e)||{eventName:e,items:[]};o.items.push(t),a(o)}}function t(e,t,n){var a=o(e),r=n||null;a!=c&&s[a].items.forEach(function(e){e.call(r,t)})}function n(e){var t=o(e);return t!=c?s[t]:null}function a(e){r(e.items)&&s.push(e)}function o(e){var t=c;return s.forEach(function(n,a){0==i(n.eventName,e)&&(t=a)}),t}function r(e){return e.length<=1}function i(e,t){return e===t?0:e>t?1:c}var c=-1,s=[],l={subscribe:e,fire:t};return l}angular.module("mainPageApp").factory("notificationService",e)}(),function(){"use strict";angular.module("mainPageApp").constant("baseUrl","http://localhost:4446/")}();